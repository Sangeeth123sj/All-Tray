{% extends "tray/college_homepage_layout.html" %}


{% block title %} Recharge a card {% endblock %}

{% comment %} {% block navbar %} 
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <li class="nav-item active">
        <a class="navbar-brand" href="{% url 'college_home' %}">Home</a>
    </li>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
        <li class="nav-item">
            <a class="nav-link" href="{% url 'college_break_edit' %}">Edit break</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'college_logout' %}">Logout</a>
        </li>
        
        </ul>
        
    </div>
    </nav> 
{% endblock %} {% endcomment %}


{% block content %}
<div class="container py-5 h-100">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-12 col-md-8 col-lg-6 col-xl-5">
        <div class="card shadow-2-strong" style="border-radius: 1rem;">
          <div class="card-body p-5 text-center">
            <br/><br/><br/>
            <h2>Enter student details</h2>
            <br/> <br/>
            <form class="form" method="POST">
                {% csrf_token %}
            <br/>
           
                <input type="email" class="form-control form-control-lg" id="email" name="email" required>
                <label class="form-label">Email</label>
                <br/> <br/>
                <input type="submit" id="enter" name="enter" class="btn btn-darker" value="enter">
                <br/>
                <hr class="my-4">
                {% if error %}
                <p id="incorrect_alert" style="color:red" >"{{ error }}"</p>
                {% endif %}
    
                <!--input type="text" id="email" name="email" autofocus-- >
            <br/>


            </form>
        </div>
    </div>
  </div>
</div>
</div>
            <script>
                $(document).ready(function(){
                $("#enter").click(function(event){
                    console.log("test on enter button");
                    if ($("#email").val() == ""){
                        $("#email").css("border-color","red");
                        document.getElementById("incorrect_alert").innerHTML = "Please enter email."
                        $('#incorrect_alert').fadeToggle(2000);
                        event.preventDefault();
                    }
            
                    else{   
                            email = $("#email").val()
                            console.log("test on enter button in else");
                //sending form fields in ajax for checking if registered email
                        $.ajax({
                            url: '/ajax/validate_recharge/',
                            data: {
                                'email': email,
                            },
                            dataType: 'json',
                            success: function (data){
                                if (data.email_status == "incorrect"){
                                    alert("Sorry incorrect email");
                                    //window.location.href = " ";
                                    event.preventDefault();
                                }
                                if(data.email_status == "correct"){
                                    $("form").submit();
                                }
            
            
                            }
                                
                        });
                    } 
            
                }); 
                });
                    
    
            </script>
    
    
            <a type="button" href="{% url 'college_home' %}" class="btn btn-darker">Back</a>
        
        
        </div>
        </div>
    
    </center>













{% endblock %}

{% block footer %} {% endblock %}